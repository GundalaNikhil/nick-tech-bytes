# ğŸ”„ API Routing Flow - Visual Guide

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     BEFORE FIX (Wrong!)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Netlify (https://nicktechbytes.netlify.app)                       â”‚
â”‚         â”‚                                                            â”‚
â”‚         â”‚  API Request                                               â”‚
â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚         â”‚                                                           â”‚â”‚
â”‚         â–¼                                                           â”‚â”‚
â”‚   http://localhost:8080  âŒ WRONG! (doesn't exist on Netlify)     â”‚â”‚
â”‚                                                                     â”‚â”‚
â”‚   Result: Connection refused / Network error                       â”‚â”‚
â”‚                                                                     â”‚â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      AFTER FIX (Correct!)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Netlify (https://nicktechbytes.netlify.app)                       â”‚
â”‚         â”‚                                                            â”‚
â”‚         â”‚  API Request                                               â”‚
â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚         â”‚                                                           â”‚â”‚
â”‚         â–¼                                                           â”‚â”‚
â”‚   https://nicktechbytes-be-dev-production.up.railway.app âœ…        â”‚â”‚
â”‚   (Railway Backend)                                                 â”‚â”‚
â”‚         â”‚                                                           â”‚â”‚
â”‚         â”‚  Response                                                 â”‚â”‚
â”‚         â–¼                                                           â”‚â”‚
â”‚   Supabase Database                                                 â”‚â”‚
â”‚         â”‚                                                           â”‚â”‚
â”‚         â–¼                                                           â”‚â”‚
â”‚   User gets data âœ…                                                 â”‚â”‚
â”‚                                                                     â”‚â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               LOCAL DEVELOPMENT (Still Works!)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  localhost:3000 (Your Computer)                                    â”‚
â”‚         â”‚                                                            â”‚
â”‚         â”‚  API Request                                               â”‚
â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚         â”‚                                                           â”‚â”‚
â”‚         â–¼                                                           â”‚â”‚
â”‚   http://localhost:8080 âœ…                                         â”‚â”‚
â”‚   (Local Spring Boot Backend)                                       â”‚â”‚
â”‚         â”‚                                                           â”‚â”‚
â”‚         â”‚  Response                                                 â”‚â”‚
â”‚         â–¼                                                           â”‚â”‚
â”‚   Local H2 Database / Supabase                                      â”‚â”‚
â”‚         â”‚                                                           â”‚â”‚
â”‚         â–¼                                                           â”‚â”‚
â”‚   You get data âœ…                                                   â”‚â”‚
â”‚                                                                     â”‚â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Environment Variable Mapping

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Environment    â”‚      Frontend URL      â”‚         Backend API URL              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Local Dev        â”‚ http://localhost:3000  â”‚ http://localhost:8080/api/v1         â”‚
â”‚ (.env.local)     â”‚                        â”‚                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Netlify Deploy   â”‚ https://nicktechbytes  â”‚ https://nicktechbytes-be-dev-       â”‚
â”‚ (Netlify Vars)   â”‚ .netlify.app           â”‚ production.up.railway.app/api/v1     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Production       â”‚ https://nicktechbytes  â”‚ https://nicktechbytes-be-dev-       â”‚
â”‚ (Netlify Vars)   â”‚ .com                   â”‚ production.up.railway.app/api/v1     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ How It Works

### Environment Variable Resolution

```javascript
// In api-client.ts
const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || "http://localhost:8080/api/v1";

// What Next.js Does:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Check Netlify Environment Variables (if deployed)       â”‚
â”‚    â†“                                                         â”‚
â”‚ 2. Check .env.production (if npm run build)                â”‚
â”‚    â†“                                                         â”‚
â”‚ 3. Check .env.development (if npm run dev)                  â”‚
â”‚    â†“                                                         â”‚
â”‚ 4. Check .env.local (highest priority for local)            â”‚
â”‚    â†“                                                         â”‚
â”‚ 5. Use default fallback: http://localhost:8080/api/v1      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ How to Verify It's Working

### On Netlify Deployment:

1. **Open DevTools** (F12)
2. **Go to Network Tab**
3. **Navigate to:** https://nicktechbytes.netlify.app/login
4. **Click Login**
5. **Look at the request URL:**

   âœ… **CORRECT:**

   ```
   Request URL: https://nicktechbytes-be-dev-production.up.railway.app/api/v1/auth/login
   ```

   âŒ **WRONG:**

   ```
   Request URL: http://localhost:8080/api/v1/auth/login
   ```

---

## ğŸš€ Deployment Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: Push Code to GitHub                               â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼                                                    â”‚
â”‚  Step 2: Netlify Detects Push                              â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼                                                    â”‚
â”‚  Step 3: Netlify Runs: npm run build                       â”‚
â”‚         â”‚                                                    â”‚
â”‚         â”‚  Environment Variables Loaded:                     â”‚
â”‚         â”‚  - NEXT_PUBLIC_API_URL (from Netlify Variables)   â”‚
â”‚         â”‚  - NEXT_PUBLIC_SUPABASE_URL                       â”‚
â”‚         â”‚  - NODE_ENV=production                            â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼                                                    â”‚
â”‚  Step 4: Build Success                                      â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼                                                    â”‚
â”‚  Step 5: Deploy to CDN                                      â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼                                                    â”‚
â”‚  Step 6: Users access site                                  â”‚
â”‚         â”‚                                                    â”‚
â”‚         â–¼                                                    â”‚
â”‚  Step 7: API calls go to Railway âœ…                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ File Structure Summary

```
nick-tech-bytes/
â”œâ”€â”€ .env.local              âŒ NOT COMMITTED (localhost backend)
â”œâ”€â”€ .env.development        âŒ NOT COMMITTED (Railway backend for local testing)
â”œâ”€â”€ .env.production         âŒ NOT COMMITTED (Railway backend for builds)
â”œâ”€â”€ .env.example            âœ… COMMITTED (template)
â”œâ”€â”€ netlify.toml            âœ… COMMITTED (Netlify config)
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ api-client.ts       âœ… Uses process.env.NEXT_PUBLIC_API_URL
â””â”€â”€ NETLIFY_ENVIRONMENT_SETUP.md  âœ… COMMITTED (guide)
```

---

## ğŸ” Security Note

```
IMPORTANT: Why we use NEXT_PUBLIC_ prefix

âœ… NEXT_PUBLIC_API_URL
   â†’ Exposed to browser (safe - just a URL)
   â†’ Users can see this in DevTools
   â†’ No secrets here

âŒ API_SECRET_KEY
   â†’ Would only work on server-side
   â†’ Never use secrets in NEXT_PUBLIC_ vars
   â†’ Keep secrets in backend only
```

---

## âœ… Final Checklist

- [x] `.env.local` created for local dev
- [x] `.env.development` created for Netlify dev testing
- [x] `.env.production` created for production builds
- [x] `netlify.toml` configured
- [x] `.env.example` updated
- [ ] **Set Netlify environment variables** â† DO THIS NOW!
- [ ] **Trigger new Netlify deploy**
- [ ] **Test on https://nicktechbytes.netlify.app**
- [ ] **Verify requests go to Railway backend**

---

**The Fix Is Complete!** ğŸ‰  
Now just set the variables in Netlify and deploy!
